<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Viewport: allow proper safe-area handling on iOS -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <title>CEORater</title>

  <link rel="canonical" href="https://ceorater.com/">

  <link rel="preconnect" href="https://get-ceos-test-847610982404.us-east4.run.app" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

  <link rel="dns-prefetch" href="https://get-ceos-test-847610982404.us-east4.run.app">

  <!-- Preload favicon -->
  <link rel="preload" href="favicon-32x32.png" as="image" type="image/png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="manifest" href="manifest.json">

  <meta name="theme-color" content="#4f46e5">

  <meta property="og:title" content="CEORater" />
  <meta property="og:description" content="NASDAQ 100 CEO Performance & Compensation Analytics" />
  <meta property="og:image" content="https://www.ceorater.com/android-chrome-512x512.png" />
  <meta property="og:url" content="https://www.ceorater.com/" />

  <!-- Twitter Card tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="CEORater" />
  <meta name="twitter:description" content="NASDAQ 100 CEO Performance & Compensation Analytics" />
  <meta name="twitter:image" content="https://www.ceorater.com/android-chrome-512x512.png" />

  <!-- iOS-Specific PWA Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="CEORater" />

  <!-- iOS Splash (optional) -->
  <link rel="apple-touch-startup-image" href="apple-touch-icon.png" />

  <!-- Prevent iOS Safari from auto-detecting phone numbers -->
  <meta name="format-detection" content="telephone=no" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- make Google Fonts non-blocking -->
  <link rel="preload"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@700&display=swap"
        as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@700&display=swap">
  </noscript>

  <!-- Tailwind (compiled) -->
  <link rel="stylesheet" href="./output.css" />

  <script>
    // Start fetching data immediately, before anything else loads
    window.dataPromise = fetch('https://get-ceos-test-847610982404.us-east4.run.app/api/data')
      .then(r => r.json())
      .catch(err => console.error('Early fetch failed:', err));
  </script>

  <!-- Your core styles (includes safe-area hardened rules) -->
  <link rel="stylesheet" href="style.css" />

  <style>
    /* Mobile-first layout for stat cards */
    #statCardContainer {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    #statCardContainer .center-hero { order: 1; }
    #statCardContainer .left-stats {
      order: 2;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    #statCardContainer .right-stats {
      order: 3;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    @media (min-width: 1024px) {
      #statCardContainer {
        flex-direction: row;
        align-items: stretch;
        gap: 1.5rem;
      }
      #statCardContainer .left-stats {
        order: 1;
        flex: 1;
        display: grid;
        grid-template-rows: 1fr 1fr;
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      #statCardContainer .center-hero {
        order: 2;
        flex-shrink: 0;
        width: 400px;
      }
      #statCardContainer .right-stats {
        order: 3;
        flex: 1;
        display: grid;
        grid-template-rows: 1fr 1fr;
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      #statCardContainer .stat-card {
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800 font-sans">
  <!-- App shell applies safe-area padding globally to main screens -->
  <div class="app-shell">
    <header id="appHeader" class="bg-white shadow-md sticky top-0 z-30">
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center flex-wrap gap-y-3 py-3">
          <div class="flex items-center gap-x-3">
            <a href="/" class="flex-shrink-0">
              <img src="favicon-32x32.png" alt="CEORater Logo" class="block md:hidden h-8 w-8" />
              <h1 class="hidden md:block text-xl sm:text-2xl md:text-3xl font-orbitron italic font-bold text-blue-600">CEORater</h1>
            </a>

            <div class="flex bg-gray-100 rounded-lg p-1 shadow-inner">
              <button id="allCeosTab" class="watchlist-tab px-2 py-1 md:px-4 md:py-1.5 rounded-md text-sm font-medium active">All CEOs</button>
              <button id="watchlistTab" class="watchlist-tab px-2 py-1 md:px-4 md:py-1.5 rounded-md text-sm font-medium flex items-center">
                <span>My Watchlist</span>
                <span id="watchlistCount" class="ml-2 text-xs bg-gray-400 text-white rounded-full px-1.5 py-0.5 hidden">0</span>
              </button>
            </div>
          </div>

          <nav class="flex items-center gap-2 sm:gap-3 ml-auto">
            <!-- Logged out state -->
            <div id="loggedOutState">
              <button id="loginBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium">
                Sign In
              </button>
            </div>

            <!-- Logged in state with dropdown -->
            <div id="loggedInState" class="hidden relative">
              <button id="userMenuButton" class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 transition text-sm">
                <div id="userAvatar" class="w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-medium text-sm">
                  U
                </div>
                <span id="userEmailDisplay" class="hidden md:inline-block text-gray-700 font-medium max-w-32 truncate"></span>
                <svg class="w-4 h-4 text-gray-500 transition-transform duration-200" id="dropdownIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>

              <!-- Updated dropdown menu -->
              <div id="userDropdown" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50">
                <div class="px-4 py-3 border-b border-gray-100">
                  <p class="text-sm font-medium text-gray-900">Signed in as</p>
                  <p id="userEmailDropdown" class="text-sm text-gray-600 truncate"></p>
                </div>
                
                <a href="profile.html" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  Account Settings
                </a>
                
                <hr class="my-1">
                
                <button id="logoutBtn" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                  </svg>
                  Sign Out
                </button>
              </div>
            </div>
          </nav>
        </div>
      </div>

      <div class="container mx-auto px-4 border-t border-gray-200">
        <div class="py-2 lg:hidden">
          <button id="toggleFiltersBtn" class="w-full px-4 py-2 text-sm font-semibold text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 flex justify-between items-center">
            <span>Show Filters & Options</span>
            <svg id="toggleFiltersIcon" class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
        </div>

        <div id="mobileFilterControls" class="hidden lg:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 py-4 items-center">
          <input id="searchInput" type="text" placeholder="Search: CEO, Ticker, or Co." class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow sm:col-span-2 lg:col-span-1" />
          <select id="founderFilter" class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow">
            <option value="">All CEOs</option>
            <option value="Y">Founder CEOs</option>
            <option value="N">Non-Founder CEOs</option>
          </select>
          <select id="sortControl" class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow">
            <option value="ceoRaterScore-desc">Sort: CEORaterScore ↓</option>
            <option value="ceoRaterScore-asc">Sort: CEORaterScore ↑</option>
            <option value="alphaScore-desc">Sort: AlphaScore ↓</option>
            <option value="alphaScore-asc">Sort: AlphaScore ↑</option>
            <option value="compensationScore-asc">Compensation Score A-F</option>
            <option value="compensationScore-desc">Compensation Score F-A</option>
            <option value="tsrAlpha-desc">TSR Alpha ↓</option>
            <option value="tsrAlpha-asc">TSR Alpha ↑</option>
            <option value="avgAnnualTsrAlpha-desc">Avg Annual TSR Alpha ↓</option>
            <option value="avgAnnualTsrAlpha-asc">Avg Annual TSR Alpha ↑</option>
            <option value="tsrValue-desc">TSR ↓</option>
            <option value="tsrValue-asc">TSR ↑</option>
            <option value="avgAnnualTsr-desc">Avg Annual TSR ↓</option>
            <option value="avgAnnualTsr-asc">Avg Annual TSR ↑</option>
            <option value="compensation-desc">Compensation ↓</option>
            <option value="compensation-asc">Compensation ↑</option>
            <option value="tenure-desc">Tenure ↓</option>
            <option value="tenure-asc">Tenure ↑</option>
            <option value="ceo-asc">CEO A—Z</option>
            <option value="ceo-desc">CEO Z—A</option>
            <option value="company-asc">Company A—Z</option>
            <option value="company-desc">Company Z—A</option>
          </select>
          <select id="industryFilter" class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow">
            <option value="">All Industries</option>
          </select>
          <select id="sectorFilter" class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow">
            <option value="">All Sectors</option>
          </select>
          <button id="downloadExcelButton" class="w-full px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition">Export to Excel</button>
        </div>
      </div>
    </header>

    <div class="container mx-auto p-4 md:p-8">
      <div id="statCardContainer" class="mb-6">
        <div class="left-stats">
          <div class="bg-white p-4 rounded-lg shadow text-center stat-card">
            <h3 class="text-sm font-medium text-gray-500">Avg. Founder CEORaterScore</h3>
            <p id="medianTsrStat" class="text-2xl font-bold mt-1 font-orbitron text-blue-600">--</p>
          </div>

          <div class="bg-white p-4 rounded-lg shadow text-center stat-card">
            <h3 class="text-sm font-medium text-gray-500">Avg. Founder AlphaScore</h3>
            <p id="avgFounderAlphaScoreStat" class="text-2xl font-bold mt-1 font-orbitron text-blue-600">--</p>
          </div>
        </div>

        <!-- Hero CEORaterScore Card -->
        <div class="center-hero mb-4 lg:mb-0">
          <div class="ceorater-stat-card rounded-xl p-6 text-center shadow-lg max-w-md mx-auto lg:max-w-none h-full flex flex-col justify-center">
            <h3 class="text-lg font-semibold text-slate-700 uppercase tracking-wider mb-2">Median CEORaterScore</h3>
            <p id="medianCeoRaterScoreStat" class="text-5xl font-orbitron font-black text-slate-800 mb-2">--</p>
            <div class="text-sm text-slate-600 font-medium">60% Alpha • 40% Comp</div>
            <div class="text-xs text-slate-500 mt-1">Comprehensive CEO Performance Rating</div>
          </div>
        </div>

        <div class="right-stats">
          <div class="bg-white p-4 rounded-lg shadow text-center stat-card">
            <h3 class="text-sm font-medium text-gray-500">Median Total Stock Return</h3>
            <p id="founderCeoStat" class="text-2xl font-bold text-gray-900 mt-1">--</p>
          </div>

          <div class="bg-white p-4 rounded-lg shadow text-center stat-card">
            <h3 class="text-sm font-medium text-gray-500">Median CEO Compensation</h3>
            <p id="medianCompStat" class="text-2xl font-bold text-gray-900 mt-1">--</p>
          </div>
        </div>
      </div>

      <main class="bg-white rounded-xl shadow-lg p-4 sm:p-6" role="main">
        <div id="lastUpdated" class="text-xs text-gray-500 text-right mb-4 h-4"></div>
        <div id="loading" class="flex justify-center items-center h-64"><div id="loading-spinner"></div></div>
        <div id="error-message" class="hidden text-center text-red-500 py-8">Unable to load market data.</div>

        <div>
          <div id="ceoCardView" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
          <p id="noResults" class="hidden text-center text-gray-500 py-8">No results found.</p>
          <div id="watchlistEmpty" class="hidden text-center text-gray-500 py-12">
            <div class="text-4xl mb-4">⭐</div>
            <h3 class="text-lg font-semibold mb-2">Your watchlist is empty</h3>
            <p>Click the star icon on any CEO card to add them to your watchlist.</p>
          </div>
        </div>
      </main>

      <footer class="text-center mt-8 py-8 border-t text-sm text-gray-500">
        <p class="mb-2">
          <a id="index-footer-methodology" class="text-blue-600 hover:underline" style="cursor: pointer;">Our Methodology</a> |
          <a id="index-footer-privacy" class="text-blue-600 hover:underline" style="cursor: pointer;">Privacy Policy</a> |
          <a id="index-footer-support" class="text-blue-600 hover:underline" style="cursor: pointer;">Support</a>
        </p>
        <p>CEORater 2025. A TEK2day Holdings company.</p>
      </footer>
    </div>
  </div> <!-- /.app-shell -->

  <!-- LOGIN MODAL (email-only) -->
  <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg p-6 w-full max-w-md relative">
      <h2 class="text-xl font-bold mb-4">Sign In to CEORater</h2>
      <p class="text-gray-600 mb-6">Sign in to save your CEO watchlist and track performance over time.</p>

      <div class="space-y-4">
<form id="signInForm" autocomplete="on" class="space-y-4">
  <!-- Email/password only -->
  <input
    id="emailInput"
    type="email"
    name="username"
    inputmode="email"
    autocapitalize="none"
    autocomplete="username"
    placeholder="Enter your email"
    required
    class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  />
  <input
    id="passwordInput"
    type="password"
    name="current-password"
    autocomplete="current-password"
    placeholder="Password"
    required
    class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  />

  <div class="text-right text-sm">
    <a href="#" id="forgotPasswordLink" class="font-medium text-blue-600 hover:text-blue-500">Forgot Password?</a>
  </div>

  <div class="flex gap-2">
    <button id="signInEmail" type="submit" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">Sign In</button>
    <button id="signUpEmail" type="button" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Sign Up</button>
  </div>
</form>
</div>

      <button id="closeLoginModalBtn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- CEO DETAIL MODAL -->
  <div id="ceoDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-lg relative max-h-full overflow-y-auto">
      <div id="modalHeader" class="pb-4 border-b"></div>
      <div id="modalBody" class="py-4"></div>
      <div id="modalFooter" class="pt-4 border-t"></div>
      <button id="closeDetailModal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- COMPARISON TRAY -->
  <div id="comparisonTray" class="hidden fixed bottom-0 left-0 right-0 bg-white shadow-2xl border-t border-gray-200 z-40">
    <div class="container mx-auto p-3 text-center sm:p-4 sm:text-left sm:flex sm:justify-between sm:items-center">
      <div class="flex items-center justify-center sm:justify-start space-x-3">
        <span id="comparisonTitle" class="font-semibold text-gray-700">Compare (0/3):</span>
        <div id="trayTickers" class="flex items-center space-x-2"></div>
      </div>
      <button id="compareNowBtn" class="w-full mt-2 sm:w-auto sm:mt-0 bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition">Compare Now →</button>
    </div>
  </div>

  <!-- COMPARISON MODAL -->
  <div id="comparisonModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col">
      <div class="p-4 border-b flex justify-between items-center flex-shrink-0">
        <div class="flex items-center gap-x-3">
          <h1 class="text-2xl font-orbitron italic font-bold text-blue-600">CEORater</h1>
          <span class="text-2xl font-light text-gray-300">|</span>
          <h2 class="text-xl font-bold text-gray-800">CEO Comparison</h2>
        </div>
        <button id="closeComparisonModalBtn" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <div class="flex-grow overflow-auto">
        <div id="comparisonTableContainer" class="p-4 hidden lg:block"></div>
        <div id="comparisonCardContainer" class="p-4 lg:hidden"></div>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-app-compat.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-auth-compat.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-firestore-compat.min.js"></script>

  <script defer src="firebase-config.js"></script>
  <script type="module" src="script.js"></script>

  <!-- Service Worker (disabled inside Capacitor app) -->
  <script>
    (function() {
      const isCapacitor = !!(window.Capacitor && typeof window.Capacitor.getPlatform === 'function' && window.Capacitor.getPlatform() !== 'web');
      if (!isCapacitor && 'serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          (window.requestIdleCallback || function(cb){setTimeout(cb, 0);})(() => {
            navigator.serviceWorker.register('service-worker.js')
              .then(reg => console.log('SW registration ok:', reg.scope))
              .catch(err => console.log('SW registration failed:', err));
          });
        });
      }
    })();
  </script>
</body>
</html>



